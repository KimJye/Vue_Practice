war 이미지 로고만 버튼 이미지 아이콘 개발 결과

개발하다가 사용자가 

사용자들이 첨부파일 하는 이미지들은 데이타다.  이런거는 디비에 들어가야 한다.

디비에 파일을 업로드 하고 유지하는 방법은 spring boot file upload를 공부하자.

파일 업로드는 

파일 다운로드는 

ㅍ일 내용을 웹브라우저에 출력해야 한다. 

지금까지 출력은 html이엇는데 파일 출력은 binary

업로드된 파일 레코드를 조회하고

파일이름을 url인코딩

출력하기전에 파일을 설정한다.

파일 내용들을 출력한다. 줄 73,74 

이때 다운로드가 된다.

이미지 태그 src에다가 url을 적어줘.

war파일에 들어잇는 이미지 url을 적어저도 된다.

그게 아니고 아까처럼 컨트롤러에서 url을 

이미지 파일을 다운로드하는 액션메소드 url을 적어줘도 된다.

img 태그에 url만 적으면 다운이아니라 클라이언트에 보여지는거다.

html5 파일 업로드 기능이 있다.

iframe무시하고 보자.

로컬스토리지와 쿠키 둘다 사용하자.

쿠키는 재부팅해도 살아있다. 사용자가 지울 수 있다.

ip는 무선공유기만 보여 플젝실에서 누가한명이 투표하면 플젝실에 잇는사람들은 다 투표를 못한다.

-------------------------



rdb에 이미지 저정안하는거 맞음 

s3에 저장하면 id가 주어지고 다운로드 ip를 요청하면서 id를 주면 id에 등록한 파일이 업로드 된다.

s3(파일저장) 파일을 저장하면 한 파일에 대해서 키(String)가 주어진다.

다운로드 api 호출하면서 그 아이디를 s3다운로드 api에 쿼리스트링으로 주면 이미지 준다. 

그럼 그 키를 rdb에 저장한다. 파일명 파일크기 키.  

< a href="http://아마존s3/download?id=${file.key}">다운로드</a>

< a href="http://아마존s3/upload/ 업로드...

 

sql server file data type => filestream =>sql, mysql은없음

file에 upload하는건 ,,

LONGBLOB types.=>mysql. 

rdb 장점: 통제, 정기적 백업

folder : 디비도 백업, 폴더도 백업, 누가 실수로 지울수잇음 그래서 보통은 안함 쀅,

보통은 파일만 저장하는 디비 따로.

-----------------------------

file upload spring

file upload filesystem vs database => answer: aws better then filestream

표준자바에 파일 저장하는 기능있음.

웹앱 폴더(url만 맞으면 자동 업데이트, 누구나 다운가능):웹브라우저가 url로 요청할수있다. 그 파일이 정적파일이면 톰캣이 그 파일을 웹브라우저에 그대로 전송. 

웹서버는 url로 요청이 오면 그 url을 웹앱에서 뒤져. 있으면 서버가 아는 파일인지아닌지 확인한다. 

톰캣서버가 아는 파일은 jsp랑 서블릿이다.

실행결과 출력이 이미지면 웹브라우저에 그려진다.

웹브라우저가 아는건 html, css,js,json,image

explore는 json모른다.

근데

서버가 웹앱 폴더 아래에서 찾는데 url만 잘 주면 보여준다.

web-inf : url로 요청해도 다운로드가 안되는 파일들이들어있다.

파일을 쉽게 다운로드해주는 방법은 웹앱폴더 안에들어가면된다.

웹앱 밑에 download폴더만들고 거기에 업로드된 파일들을 여기다 저장한다.

context/download/파일명

이렇게하면 파일명도 문제고 보안도 문제다.

핵데이에서는 위 방법쓰자 보안신경안써도 된다.

웹앱밑에 download

디비 파일명 저장하고 이름을 바꿔

파일 이름만 디비 저장,  id를 파일명으로 바꿔서 웹앱밑에 저장

디비 : 원래 파일명, 바뀐 파일명.



그래서

web-INF에 저장하자.

강의자료에서 디비에서 조회하는 부분을 파일 경로로 바꾸면된다.



업로드 폴더는 폴더를 만들어야 한다.  